/*********************************************************************************/
/********** THIS FILE IS GENERATED BY TOUCHGFX DESIGNER, DO NOT MODIFY ***********/
/*********************************************************************************/
#include <gui_generated/samepatient_screen/SamePatientViewBase.hpp>
#include <touchgfx/Color.hpp>
#include <BitmapDatabase.hpp>
#include <texts/TextKeysAndLanguages.hpp>

SamePatientViewBase::SamePatientViewBase() :
    waitForDataCollectionCounter(0),
    flexButtonCallback(this, &SamePatientViewBase::flexButtonCallbackHandler)
{

    __background.setPosition(0, 0, 480, 272);
    __background.setColor(touchgfx::Color::getColorFromRGB(0, 0, 0));

    ChildrenBackground.setBitmap(touchgfx::Bitmap(BITMAP_BACKEND4_ID));
    ChildrenBackground.setPosition(0, 0, 480, 272);
    ChildrenBackground.setVisible(false);
    ChildrenBackground.setScalingAlgorithm(touchgfx::ScalableImage::NEAREST_NEIGHBOR);

    DarkBackground.setBitmap(touchgfx::Bitmap(BITMAP_BACKEND3_ID));
    DarkBackground.setPosition(0, 0, 480, 272);
    DarkBackground.setVisible(false);
    DarkBackground.setScalingAlgorithm(touchgfx::ScalableImage::NEAREST_NEIGHBOR);

    DefaultBackground.setBitmap(touchgfx::Bitmap(BITMAP_BACKEND2_ID));
    DefaultBackground.setPosition(0, 0, 480, 272);
    DefaultBackground.setScalingAlgorithm(touchgfx::ScalableImage::NEAREST_NEIGHBOR);

    Title.setXY(182, 3);
    Title.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    Title.setLinespacing(0);
    Title.setTypedText(touchgfx::TypedText(T___SINGLEUSE_83FX));

    Name.setXY(38, 51);
    Name.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    Name.setLinespacing(0);
    Name.setTypedText(touchgfx::TypedText(T___SINGLEUSE_XC7I));

    Age.setXY(51, 91);
    Age.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    Age.setLinespacing(0);
    Age.setTypedText(touchgfx::TypedText(T___SINGLEUSE_5OJ3));

    Height.setXY(33, 129);
    Height.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    Height.setLinespacing(0);
    Height.setTypedText(touchgfx::TypedText(T___SINGLEUSE_O8FC));

    Weight.setXY(30, 168);
    Weight.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    Weight.setLinespacing(0);
    Weight.setTypedText(touchgfx::TypedText(T___SINGLEUSE_6W7I));

    Gender.setXY(27, 207);
    Gender.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    Gender.setLinespacing(0);
    Gender.setTypedText(touchgfx::TypedText(T___SINGLEUSE_3U0V));

    NameBox.setPosition(84, 44, 347, 38);
    NameBox.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    NameBox.setAlpha(90);

    AgeBox.setPosition(84, 83, 347, 38);
    AgeBox.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    AgeBox.setAlpha(90);

    HeightBox.setPosition(84, 122, 347, 38);
    HeightBox.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    HeightBox.setAlpha(90);

    WeightBox.setPosition(84, 161, 347, 38);
    WeightBox.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    WeightBox.setAlpha(90);

    GenderBox.setPosition(84, 200, 347, 38);
    GenderBox.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    GenderBox.setAlpha(90);

    SaveBtnBox.setPosition(208, 239, 95, 32);
    SaveBtnBox.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    SaveBtnBox.setAlpha(90);

    SaveBtn.setText(TypedText(T___SINGLEUSE_QBOP));
    SaveBtn.setTextPosition(-1, 3, 95, 32);
    SaveBtn.setTextColors(touchgfx::Color::getColorFromRGB(250, 250, 250), touchgfx::Color::getColorFromRGB(133, 133, 133));
    SaveBtn.setPosition(208, 239, 95, 32);
    SaveBtn.setAction(flexButtonCallback);

    HeightUnit.setXY(410, 129);
    HeightUnit.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    HeightUnit.setLinespacing(0);
    HeightUnit.setTypedText(touchgfx::TypedText(T___SINGLEUSE_ME17));

    WeightUnit.setXY(408, 168);
    WeightUnit.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    WeightUnit.setLinespacing(0);
    WeightUnit.setTypedText(touchgfx::TypedText(T___SINGLEUSE_TJV8));

    NameTextArea.setPosition(84, 49, 346, 26);
    NameTextArea.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    NameTextArea.setLinespacing(0);
    Unicode::snprintf(NameTextAreaBuffer, NAMETEXTAREA_SIZE, "%s", touchgfx::TypedText(T___SINGLEUSE_L4UA).getText());
    NameTextArea.setWildcard(NameTextAreaBuffer);
    NameTextArea.setTypedText(touchgfx::TypedText(T___SINGLEUSE_BEJS));

    AgeTextArea.setPosition(85, 89, 346, 26);
    AgeTextArea.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    AgeTextArea.setLinespacing(0);
    Unicode::snprintf(AgeTextAreaBuffer, AGETEXTAREA_SIZE, "%s", touchgfx::TypedText(T___SINGLEUSE_3BEM).getText());
    AgeTextArea.setWildcard(AgeTextAreaBuffer);
    AgeTextArea.setTypedText(touchgfx::TypedText(T___SINGLEUSE_EJJZ));

    HeightTextArea.setPosition(85, 129, 346, 26);
    HeightTextArea.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    HeightTextArea.setLinespacing(0);
    Unicode::snprintf(HeightTextAreaBuffer, HEIGHTTEXTAREA_SIZE, "%s", touchgfx::TypedText(T___SINGLEUSE_YW3W).getText());
    HeightTextArea.setWildcard(HeightTextAreaBuffer);
    HeightTextArea.setTypedText(touchgfx::TypedText(T___SINGLEUSE_6736));

    WeightTextArea.setPosition(85, 167, 346, 26);
    WeightTextArea.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    WeightTextArea.setLinespacing(0);
    Unicode::snprintf(WeightTextAreaBuffer, WEIGHTTEXTAREA_SIZE, "%s", touchgfx::TypedText(T___SINGLEUSE_WMJE).getText());
    WeightTextArea.setWildcard(WeightTextAreaBuffer);
    WeightTextArea.setTypedText(touchgfx::TypedText(T___SINGLEUSE_XS50));

    GenderTextArea.setPosition(84, 206, 346, 26);
    GenderTextArea.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    GenderTextArea.setLinespacing(0);
    Unicode::snprintf(GenderTextAreaBuffer, GENDERTEXTAREA_SIZE, "%s", touchgfx::TypedText(T___SINGLEUSE_MO78).getText());
    GenderTextArea.setWildcard(GenderTextAreaBuffer);
    GenderTextArea.setTypedText(touchgfx::TypedText(T___SINGLEUSE_MHB1));

    LoadingPopUp.setBackground(touchgfx::BitmapId(BITMAP_WARNVING_ID), 76, 45);
    LoadingPopUp.setShadeColor(touchgfx::Color::getColorFromRGB(0, 0, 0));
    LoadingPopUp.setShadeAlpha(150);

    ErrorMsgTextArea.setPosition(47, 66, 238, 50);
    ErrorMsgTextArea.setVisible(false);
    ErrorMsgTextArea.setColor(touchgfx::Color::getColorFromRGB(252, 5, 5));
    ErrorMsgTextArea.setLinespacing(0);
    ErrorMsgTextArea.setTypedText(touchgfx::TypedText(T___SINGLEUSE_VQAS));
    LoadingPopUp.add(ErrorMsgTextArea);

    LoadingAnimation.setXY(144, 70);
    LoadingAnimation.setBitmaps(BITMAP_MINI_FLAT_HOURGLASS_0_ID, BITMAP_MINI_FLAT_HOURGLASS_321_ID);
    LoadingAnimation.setUpdateTicksInterval(6);
    LoadingAnimation.startAnimation(false, true, true);
    LoadingPopUp.add(LoadingAnimation);

    BackBtnBox.setPosition(371, 3, 95, 32);
    BackBtnBox.setColor(touchgfx::Color::getColorFromRGB(255, 255, 255));
    BackBtnBox.setAlpha(90);

    BackBtn.setText(TypedText(T___SINGLEUSE_ROIJ));
    BackBtn.setTextPosition(-6, 7, 95, 32);
    BackBtn.setTextColors(touchgfx::Color::getColorFromRGB(255, 255, 255), touchgfx::Color::getColorFromRGB(133, 133, 133));
    BackBtn.setPosition(371, 3, 95, 32);
    BackBtn.setAction(flexButtonCallback);

    BackArrow.setBitmap(touchgfx::Bitmap(BITMAP_GROUPE49_ID));
    BackArrow.setPosition(384, 14, 18, 11);
    BackArrow.setScalingAlgorithm(touchgfx::ScalableImage::NEAREST_NEIGHBOR);

    add(__background);
    add(ChildrenBackground);
    add(DarkBackground);
    add(DefaultBackground);
    add(Title);
    add(Name);
    add(Age);
    add(Height);
    add(Weight);
    add(Gender);
    add(NameBox);
    add(AgeBox);
    add(HeightBox);
    add(WeightBox);
    add(GenderBox);
    add(SaveBtnBox);
    add(SaveBtn);
    add(HeightUnit);
    add(WeightUnit);
    add(NameTextArea);
    add(AgeTextArea);
    add(HeightTextArea);
    add(WeightTextArea);
    add(GenderTextArea);
    add(LoadingPopUp);
    add(BackBtnBox);
    add(BackBtn);
    add(BackArrow);
}

void SamePatientViewBase::setupScreen()
{

    //RequestLastPatient
    //When screen transition begins call virtual function
    //Call RequestLastPatient
    RequestLastPatient();

    //WaitForDataCollection
    //When RequestLastPatient completed delay
    //Delay for 1000 ms (60 Ticks)
    waitForDataCollectionCounter = WAITFORDATACOLLECTION_DURATION;

}

//Handles delays
void SamePatientViewBase::handleTickEvent()
{
    if(waitForDataCollectionCounter > 0)
    {
        waitForDataCollectionCounter--;
        if(waitForDataCollectionCounter == 0)
        {
            //VerifyData
            //When WaitForDataCollection completed call virtual function
            //Call VerifyData
            VerifyData();
        }
    }
}

void SamePatientViewBase::flexButtonCallbackHandler(const touchgfx::AbstractButtonContainer& src)
{
    if (&src == &SaveBtn)
    {
        //GotoMain
        //When SaveBtn clicked change screen to Main
        //Go to Main with screen transition towards East
        application().gotoMainScreenWipeTransitionEast();
    }
    else if (&src == &BackBtn)
    {
        //GotoHome
        //When BackBtn clicked change screen to Home
        //Go to Home with screen transition towards West
        application().gotoHomeScreenWipeTransitionWest();
    }
}
